<div class="container content-box mt-5" *ngIf="user; else loading">
  <h2 class="text-center title mb-4">Modifier le profil</h2>

  <div *ngIf="message" class="alert alert-success text-center">{{ message }}</div>
  <div *ngIf="error" class="alert alert-danger text-center">{{ error }}</div>

  <form (ngSubmit)="saveProfile()" #editForm="ngForm">

     <!-- Photo -->
  <div class="mb-3 text-center">
    <img
      [src]="'https://127.0.0.1:8000/uploads/profiles/' + (user.photo || 'sans_photo.png')"
      alt="Photo de profil"
      class="rounded shadow-sm mb-2"
      width="160"
      height="160"
    />
    <input type="file" (change)="onPhotoSelected($event)" class="form-control mt-2" />
  </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <label>Nom :</label>
        <input type="text" [(ngModel)]="user.nom" name="nom" class="form-control" required />
      </div>

      <div class="col-md-6 mb-3">
        <label>PrÃ©nom :</label>
        <input type="text" [(ngModel)]="user.prenom" name="prenom" class="form-control" required />
      </div>

      <div class="col-md-6 mb-3">
        <label>Surnom :</label>
        <input type="text" [(ngModel)]="user.surnom" name="surnom" class="form-control" />
      </div>

      <div class="mb-3">
        <label for="role" class="form-label">RÃ´le :</label>
        <select
          id="role"
          class="form-select"
          [(ngModel)]="user.role"
          name="role"
          required
        >
          <option value="ROLE_CLIENT">Client</option>
          <option value="ROLE_PROPRIETAIRE">PropriÃ©taire</option>
        </select>
      </div>

      <div class="col-md-6 mb-3">
        <label>Adresse :</label>
        <input type="text" [(ngModel)]="user.adresse" name="adresse" class="form-control" />
      </div>

      <div class="col-md-6 mb-3">
        <label>TÃ©lÃ©phone :</label>
        <input type="text" [(ngModel)]="user.telephone" name="telephone" class="form-control" />
      </div>

      <div class="col-md-6 mb-3">
        <label>Date de naissance :</label>
        <input type="date" [(ngModel)]="user.date_naissance" name="date_naissance" class="form-control" />
      </div>

      <div class="col-md-6 mb-3">
        <label>Ville :</label>
        <input type="text" [(ngModel)]="user.ville" name="ville" class="form-control" />
      </div>

      <div class="col-md-6 mb-3">
        <label>Pays :</label>
        <input type="text" [(ngModel)]="user.pays" name="pays" class="form-control" />
      </div>
    </div>

          <div class="text-center mt-4">
      <button type="submit" class="btn me-2">ðŸ’¾ Enregistrer</button>
      <button type="button" class="btn" (click)="cancelEdit()">Annuler</button>
    </div>
  </form>
</div>

<ng-template #loading>
  <div class="text-center mt-5">
    <div class="spinner-border text-info" role="status"></div>
    <p class="mt-3">Chargement du profil...</p>
  </div>
</ng-template>
