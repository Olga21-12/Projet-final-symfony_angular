<div class="container mt-5">
  <h2 class="title text-center mb-4">Nos logements</h2>
  <small class="text-muted d-block text-center mb-4">
    {{ totalBiens }} annonces trouv√©es
  </small>

  <div class="row">
    <!-- Colonne de filtres -->
    <div class="col-lg-3 mb-4">
      <app-bien-filtre (search)="onSearch($event)"></app-bien-filtre>
    </div>

    <!-- Colonne des cartes de biens -->
    <div class="col-lg-9">
      <div *ngIf="loading" class="text-center mt-5">
        <div class="spinner-border text-info" role="status"></div>
        <p class="mt-3">Chargement des biens...</p>
      </div>

      <div *ngIf="error" class="alert alert-danger text-center">{{ error }}</div>

      <div class="row" *ngIf="!loading && !error">
        <div class="col-md-4 mb-4" *ngFor="let bien of biens">
          <div class="card h-100 shadow-sm">

            <h5 class="card-title">{{ bien.type }} ‚Äî {{ bien.activite }}</h5>

            <img
              [src]="'https://127.0.0.1:8000' + (bien.photos && bien.photos.length ? bien.photos[0] : '/uploads/biens/sans_photo.png')"
              class="card-img-top"
              alt="Photo du bien"
            />

            <div class="card-body">
              <p
                class="card-text"
                [innerHTML]="bien.description | truncate: 100 : true : '...' : true"
              ></p>

              <p class="mb-1">
                <strong>
                <span [ngClass]="bien.disponibilite ? 'text-success' : 'text-danger'">
                  {{ bien.disponibilite ? 'Disponible' : 'Non disponible' }}
                </span></strong>
              </p>

              <div class="card-info mt-2">
                <p><strong>{{ bien.prix | currency: 'EUR' }}</strong></p>
                <p>
                  {{ bien.emplacement.ville }}, {{ bien.emplacement.pays }}<br />
                  {{ bien.surface }} m¬≤ ‚Ä¢ {{ bien.nombre_de_chambres }} chambres
                </p>

                <small class="text-secondary d-block">
                  üßç {{ bien.proprietaire }}<br />
                  ‚è± ajout√© il y a {{ bien.created_ago }} jour{{ bien.created_ago > 1 ? 's' : '' }}
                </small>
              </div>

              <button class="btn btn-info mt-auto" (click)="voirBien(bien.id)">
                Voir plus
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Pagination  -->

      <app-paginator
        [currentPage]="currentPage"
        [totalPages]="totalPages"
        (pageChange)="changePage($event)"
      ></app-paginator>

    </div>
  </div>
</div>
